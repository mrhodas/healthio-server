<!doctype html>
<html>

<head>
    <title>Producer</title>

</head>

<body>
    <div>
        <form>
            Monitor ID:<br>
            <input type="text" id="mid"><br>
            Generate Number Between:<br>
            <input type="text" id='low'><br>
            <input type="text" id='high'><br>
            <input type="submit" value="Submit">
        </form>
    </div>

    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
        var room = io('/monitor');
        var mid;
        var low;
        var high;

        var timer;
        var connected = false;

        $('form').submit(function() {
            mid = $('#mid').val();
            
            low = $('#low').val();
            high = $('#high').val();
            
            console.log("set Monitor ID to " + mid);
            timer = setInterval(sendData, 3000);
            return false;
        });

        room.on('connect', function(msg) {
            console.log('Connected to server');
            connected = true;
        });

        room.on('disconnect', function(msg) {
            console.log('Disconnected from Server');
            connected = false;
        });

        function sendData() {
            var d = {
                mid: mid,
                data: Math.round(Math.random() * (high - low) + low)
            };
            if (connected) {
                console.log('data sent');
                room.emit('patient update', d);
            }
        }

    </script>
</body>

</html>